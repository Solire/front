{% macro link(title, url) %}
   <a href="{{ url }}">{{ title }}</a>
{% endmacro %}

{% macro ul(items, attributes, menu_level) %}
    {% import _self as links_tree %}
    {% if items %}
        <ul>
        {% for item in items %}
            <li{{ item.attributes }}>
                {{ links_tree.link(item.title, item.url) }}
                {% if item.children %}
                    {{ links_tree.ul(item.children, attributes, menu_level + 1) }}
                {% endif %}
            </li>
        {% endfor %}
        </ul>
    {% endif %}
{% endmacro %}